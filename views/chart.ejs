<script>
  // Dynamically create the chart visualization for each db table.

  const chartData = [];
  let idIncrement = 1;

  const jsonString1 = `<%-  JSON.stringify(chart1) %>`;
  const jsonObject1 = JSON.parse(jsonString1);
  chartData.push(jsonObject1);
  const jsonString2 = `<%-  JSON.stringify(chart2) %>`;
  const jsonObject2 = JSON.parse(jsonString2);
  chartData.push(jsonObject2);
  const jsonString3 = `<%-  JSON.stringify(chart3) %>`;
  const jsonObject3 = JSON.parse(jsonString3);
  chartData.push(jsonObject3);
  const jsonString4 = `<%-  JSON.stringify(chart4) %>`;
  const jsonObject4 = JSON.parse(jsonString4);
  chartData.push(jsonObject4);
  const jsonString5 = `<%-  JSON.stringify(chart5) %>`;
  const jsonObject5 = JSON.parse(jsonString5);
  chartData.push(jsonObject5);

  // console.log(chartData);

  chartData.forEach((data) => {
    const div = document.createElement("div");
    const main = document.getElementById("main");
    main.appendChild(div);
    div.id = `div${idIncrement}`;
    const canvas = document.createElement("canvas");
    canvas.style.width = 100;
    canvas.style.height = 60;
    canvas.id = `chart${idIncrement}`;
    div.appendChild(canvas);

    const ctx = document.getElementById(`chart${idIncrement}`).getContext("2d");

    const chart = new Chart(ctx, {
      type: "line",
      data: {
        labels: data.year,
        datasets: [
          {
            label: data.name,
            data: data.value,
            backgroundColor: [
              "rgba(255, 99, 132, 0.2)",
              "rgba(54, 162, 235, 0.2)",
              "rgba(255, 206, 86, 0.2)",
              "rgba(75, 192, 192, 0.2)",
              "rgba(153, 102, 255, 0.2)",
              "rgba(255, 159, 64, 0.2)",
            ],
            borderColor: [
              "rgba(255, 99, 132, 1)",
              "rgba(54, 162, 235, 1)",
              "rgba(255, 206, 86, 1)",
              "rgba(75, 192, 192, 1)",
              "rgba(153, 102, 255, 1)",
              "rgba(255, 159, 64, 1)",
            ],
            borderWidth: 1,
          },
        ],
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
          },
        },
      },
    });
    idIncrement += 1;
  });
</script>
